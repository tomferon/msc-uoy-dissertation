\documentclass[a4paper]{article}

\usepackage{lastpage}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot{}
\fancyfoot[LE,RO]{\thepage \thinspace\thinspace of \pageref{LastPage}}
% \fancyfoot[RE,LO]{Dissertation}

\usepackage[utf8]{inputenc}
\usepackage{amsthm}
\newtheorem{definition}{Definition}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}

\usepackage[backend=biber]{biblatex}
\addbibresource{bibliography.bib}

\begin{document}

FIXME: Quick intro to the topic and explanation of what is coming.

\section{Preliminaries}

% Develop a preliminaries section, in which the tools of stochastic Ito calculus are introduced. Assume that your reader has background in the standard undergraduate modules in mathematics (including analysis, measure theory, probability theory and statistics), but introduce all the notions concerning stochastic processes from scratch. This section should not contain any proofs. Simply set up and state the needed results, providing citations to sources. While developing this section, restrict to the setup needed for the model from [2].

This section establishes the preliminaries of stochastic calculus required by further sections without proofs. See \textcite{capinski_stochastic_2012} and \textcite{capinski_blackscholes_2012} for further details.

In the following, we implicitly assume that we work in a probability space $(\Omega, \mathcal{F}, P)$ unless stated otherwise. We also restrict ourselves to processes defined on a time interval $[0,T]$ for some $T$ as it is sufficient in this context. When relevant, we further assume that we work with a filtration $(\mathcal{F}_t)_{t \in [0,T]}$.

\begin{definition}
  A \textbf{stochastic process} is a measurable function $X : [0,T] \times \Omega \to \mathbb{R}^d$ with respect to the $\sigma$-field $\mathcal{B}([0,T]) \times \mathcal{F}$.
\end{definition}

Note that $X(t)$ for $t \in [0,T]$ denotes the random variable $\omega \mapsto X(t,\omega)$.

\begin{definition}
  A \textbf{filtration} is a family $(\mathcal{F}_t)_{t \in [0,T]}$ of sub-$\sigma$-fields of $\mathcal{F}$ such that $\mathcal{F}_s \subseteq \mathcal{F}_t$ for all $0 \le s < t \le T$.
\end{definition}

\begin{definition}
  A stochastic process $X$ is said to be \textbf{adapted} to a filtration $(\mathcal{F}_t)_{t \in [0,T]}$ if for all $t \in [0,T]$, $X(t)$ is $\mathcal{F}_t$-measurable.
\end{definition}

\begin{definition}
  A stochastic process $X$ is said to be a \textbf{martingale} for a filtration $\mathcal{F}_t$ if $X(t)$ is integrable for each $t \in [0,T]$ and

  \begin{align*}
    \mathbb{E}(X(t) \mid \mathcal{F}_s) = X(s)
  \end{align*}

  for all $0 \le s < t \le T$.
\end{definition}

A very important stochastic process is the Wiener process. Here, we give an axiomatic definition. For a construction of such a process and thus a proof of existence, see \textcite{capinski_stochastic_2012}.

\begin{definition}
  A \textbf{Wiener process}, also called Brownian motion, is a stochastic process $(W(t))_{t \in [0,T]}$ that satisfies

  \begin{itemize}
    \item $W(0) = 0$ almost surely,
    \item for all $0 \le s < t \le T$, the increment $W(t) - W(s)$ follows a normal distribution with mean 0 and variance $t - s$,
    \item for all $0 \le t_1 < t_2 < cdots < t_m$, the increments $W(t_k) - W(t_{k-1}), k=2,\ldots,m$ are independent,
    \item almost all paths are continuous, i.e. $t \mapsto W(t,\omega)$ are continuous functions for almost all $\omega \in \Omega$.
  \end{itemize}
\end{definition}


FIXME: Definition of stochastic integral

FIXME: Definition of It\^o process

FIXME: Definition of stochastic differential equation

FIXME: Explanation of notation as stochastic differentials

FIXME: Uniqueness of characteristics of It\^o processes

FIXME: It\^o formula

% FIXME: Solution to dS = u S dt + s S dW

FIXME: Multi-dimensional It\^o processes

FIXME: Multi-dimensional It\^o formula

FIXME: Uniqueness of characteristics of multi-dimensional It\^o processes

FIXME: Prove that the following is a martingale using the multi-dimensional It\^o formula.

\begin{align}\label{eq:exp-sums-martingale}
  M(t) = \exp \left( - \sum_{j=1}^{d} \theta_j(s) \mathrm{d}W_j(s) - \frac{1}{2} \sum_{j=1}^{d} \theta_j(s)^2 \mathrm{d}s \right).
\end{align}

FIXME: It\^o product rule

FIXME: Physical v risk-neutral probability

FIXME: Pricing with risk-neutral probability

FIXME: Girsanov theorem

FIXME: Multi-dimensional Girsanov theorem

FIXME: Martingale representation theorem

FIXME: Multi-dimensional martingale representation theorem

\pagebreak
\section{Multi-asset Black-Scholes model}

% Introduce the multidimensional Black-Scholes model. Use [1] as a reference.

The one-dimensional Black-Scholes consist of one risk-free asset with price $A(t)$ and one risky asset with price $S(t)$ at time $t$ satisfying the following stochastic differential equations.

\begin{align*}
  \mathrm{d}A(t) &= r A(t) \mathrm{d}t,\\
  \mathrm{d}S(t) &= \mu S(t) \mathrm{d}t + \sigma S(t) \mathrm{d}W(t),
\end{align*}

where $r$ is the risk-free rate, $W$ is a Wiener process with respect to the physical probability, $\mu$ is the drift and $\sigma$ the volatility.

In this section, we expand this model in two ways to arrive at the multi-asset Black-Scholes model with variable coefficients. First, we extend to $d$ risky assets $S_j(t), j =  1, \ldots, d$, each driven by $d$ independent Wiener process $W_i(t), i = 1, \ldots, d$. Second, the coefficients are now functions of time. The dynamics of risky assets becomes

\begin{align}\label{eq:multi-bs-eq}
  \mathrm{d}S_i(t) = \mu_i(t) S_i(t) \mathrm{d}t + \sum_{j=1}^{d} c_{ij}(t) S_i(t) \mathrm{d}W_j(t), \text{ for } i = 1,\ldots,d.
\end{align}

Some further assumptions are required on the coefficients: $\mu_i(t), c_{ij}(t)$ are adapted to the filtration generated by the Wiener processes, have continuous paths and are bounded by a deterministic constant. We'll also assume that the matrix of volatily coefficients $\mathbf{C}(t) = [c_{ij}(t)]_{i,j=1,\ldots,d}$ is invertible.

FIXME: Justificiation of $d$ Wiener processes for $d$ assets?

FIXME: Comment about the fact that assumptions are justified in the following development + references to where.

FIXME: Recap of what will be done

\subsection{Solution}

The solution to \eqref{eq:multi-bs-eq} is

\begin{align*}
  S_i(t) &= S_i(0) \exp \left( \int_0^t \mu_i(t) \mathrm{d}t - \frac{1}{2} \sum_{j=1}^{d} \int_0^d c_{ij}^2(t) \mathrm{d}t + \sum_{j=1}^d \int_0^t c_{ij}(t) \mathrm{d}W_j(t) \right).
\end{align*}

This can be verified using the multi-dimensional It\^o formula. Uniqueness follows from \eqref{eq:ito-uniqueness-md} since we assume

FIXME: \^{} Prove it or at least verify it for $d=2$?

\pagebreak
\subsection{Risk-neutral probability}

We want to find a probability measure under which the discounted stock prices form martingales. This will in turn allow us to express derivative prices in terms of conditional expectations.

Very briefly, this is achieved in the one-dimensional Black-Scholes model by noticing that

\begin{align*}
  \mathrm{d}S(t)
  &= \mu S(t) \mathrm{d}t + \sigma S(t) \mathrm{d}W(t)\\
  &= r S(t) \mathrm{d}t + \sigma S(t) \left(\frac{\mu - r}{\sigma} \mathrm{d}t + \mathrm{d}W(t)\right)
\end{align*}

such that the discounted stock price $\tilde{S}(t) = e^{-rt}S(t)$ is a martingale with respect to the probability given by the Girsanov theorem (FIXME: add reference) with $b(t) = \frac{\mu - r}{\sigma}$. We will use a similar technique to obtain a risk-neutral probability for the multi-asset Black-Scholes model with variable coefficients.

First, notice that for all $i=1,\ldots,d$,

\begin{align*}
  \mathrm{d}S_i(t)
  &= \mu_i(t) S_i(t) \mathrm{d}t + \sum_{j=1}^{d} c_{ij}(t) S_i(t) \mathrm{d}W_j(t)\\
  &= r S_i(t) \mathrm{d}t + (\mu_i(t) - r) S_i(t) \mathrm{d}t + \sum_{j=1}^{d} c_{ij}(t) S_i(t) \mathrm{d}W_j(t)\\
  &= r S_i(t) \mathrm{d}t + \sum_{j=1}^{d} \alpha_j(t) \frac{\mu_i(t) - r}{c_{ij}(t)} c_{ij}(t) S_i(t) \mathrm{d}t + \sum_{j=1}^{d} c_{ij}(t) S_i(t) \mathrm{d}W_j(t)\\
  &= r S_i(t) \mathrm{d}t + \sum_{j=1}^{d} c_{ij}(t) S_i(t) \left(\alpha_j(t) \frac{\mu_i(t) - r}{c_{ij}(t)} \mathrm{d}t + \mathrm{d}W_j(t)\right)
\end{align*}

where we assume that we have some $\alpha_j(t)$ are such that $\sum_{j=1}^d \alpha_j(t) = 1$ for all $t$. We will find the values for $\alpha_j(t)$ in the rest of this section. These coefficients serve to ``spread'' the term $(\mu_i(t) - r) S_i(t) \mathrm{d}t$ over each of the Wiener processes $W_j(t)$.

In order to apply the multi-dimensional Girsanov theorem, we want the terms $\alpha_j(t) \frac{\mu_i(t) - r}{c_{ij}(t)}$ to not depend on $i$. Thus, let

\begin{align*}
  \theta_j(t) = \alpha_j(t) \frac{\mu_i(t) - r}{c_{ij}(t)}.
\end{align*}

We have

\begin{align*}
  \sum_{j=1}^{d} \alpha_j(t) = 1
  \iff \sum_{j=1}^{d} \frac{\theta_j(t) c_{ij}(t)}{\mu_i(t) - r} = 1
  \iff \sum_{j=1}^{d} \theta_j(t) c_{ij}(t) = \mu_i(t) - r
\end{align*}

for all $i$. Thus, in vector form, we have

\begin{align*}
  \mathbf{C} \mathbf{\theta} = \mathbf{\mu} - r
  \iff \mathbf{\theta} = \mathbf{C}^{-1} (\mathbf{\mu} - r).
\end{align*}

That is, the assumption that $\mathbf{C}$ is invertible implies the existence and uniqueness of the coefficients $\theta_j(t)$ and $\alpha_j(t)$ since $\alpha_j(t) = \frac{\theta_j(t) c_{ij}(t)}{\mu_i(t) - r}$.

Consider the process

\begin{align*}
  M(t) = \exp \left( - \sum_{j=1}^{d} \int_0^t \theta_j(s) \mathrm{d}W_j(s) - \frac{1}{2} \sum_{j=1}^{d} \int_0^t \theta_j(s)^2 \mathrm{d}s \right).
\end{align*}

FIXME: Use prop 6.16 from BS book to show it's a martingale.

By \eqref{eq:exp-sums-martingale}, $M(t)$ is a martingale (FIXME: check conditions on $\theta$?). Thus, by the multi-dimensional Girsanov theorem, we obtain a probability $Q$ with density $\frac{\mathrm{d}Q}{\mathrm{P}} = M(T)$ such that $\mathrm{d}W^Q_j(t) = \theta_j(t) \mathrm{d}t + \mathrm{d}W_j(t)$ is a Wiener process under $Q$ for all $j$.

This in turn implies that

\begin{align*}
  \mathrm{d}S_i(t)
  &= r S_i(t) \mathrm{d}t + \sum_{j=1}^{d} c_{ij}(t) S_i(t) \left(\alpha_j(t) \frac{\mu_i(t) - r}{c_{ij}(t)} \mathrm{d}t + \mathrm{d}W_j(t)\right)\\
  &= r S_i(t) \mathrm{d}t + \sum_{j=1}^{d} c_{ij}(t) S_i(t) \mathrm{d}W^Q_j(t).
\end{align*}

By \eqref{eq:mabs-solution}, the solution to the stochastic differential equation above is

\begin{align*}
  S_i(t)
  = S_i(0) \exp \left( r t - \frac{1}{2} \sum_{j=1}^{d} \int_0^t c_{ij}(s)^2 \mathrm{d}s + \sum_{j=1}^{d} \int_0^t c_{ij}(s) W^Q_j(s) \right).
\end{align*}

But then,

\begin{align*}
  \tilde{S}_i(t)
  = S_i(0) \exp \left( - \frac{1}{2} \sum_{j=1}^{d} \int_0^t c_{ij}(s)^2 \mathrm{d}s + \sum_{j=1}^{d} \int_0^t c_{ij}(s) W^Q_j(s) \right).
\end{align*}

FIXME: Construction of a risk-neutral probability

\subsection{Strategies}

FIXME: Definition of contigent claim

FIXME: Definition of strategy

FIXME: Self-financing condition

FIXME: Definition of martingale strategy

FIXME: Definition of admissible strategy

FIXME: Explanation as to why we need admissiblity?

FIXME: Definition of replicating strategy

FIXME: Representation of contigent claims as processes assumed to be It\^o

\subsection{Completeness}

FIXME: Completeness of the model

\subsection{Pricing of derivatives}

FIXME: Pricing with risk-neutral expectations + comment about unknown joint distribution

FIXME: Black-Scholes PDE

\section{The Fokker-Planck equation}

% Introduce the Fokker-Planck equation. Use [4] as a reference.

FIXME

\section{Dupire's equation}

% Give a detailed derivation of the Dupire’s equation (equation starting with ∂C = on page 171 in [2]). ∂T
% Use section 2 from [2] and the section ‘The continuous time theory’ from [3] as a source for the proof.

FIXME

\section{Generalisation to multiple assets}

% Provide the setup and give a detailed proof of Theorem 1 from [2]. This should be based on section 3 from [2]

FIXME

\section{Alternative proof}

% Present the alternative proof of Theorem 1, anded on Appendix A from [2].

FIXME

\section{Numerical example}

% Give a numerical example of how Theorem 1 can be applied to recover aij. You can restrict to the simplest setting of a two dimensional Black-Scholes model.

FIXME

\pagebreak
\printbibliography

\end{document}
